<section class="products-container">
  <div class="header-controls">
    <h2 class="title">Lista de Productos</h2>
    
    <div class="limit-selector">
      <label for="limit">Ver:</label>
      <select id="limit" [(ngModel)]="limit" (change)="onLimitChange()" class="limit-select">
        <option *ngFor="let option of limitOptions" [value]="option">
          {{ option }} 
        </option>
      </select>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading">
    <span class="material-icons spin">refresh</span> Cargando productos...
  </div>

  <!-- Error -->
  <div *ngIf="error" class="error">
    <span class="material-icons">error_outline</span> {{ error }}
    <button class="retry" (click)="loadProducts()">
      <span class="material-icons">refresh</span> Reintentar
    </button>
  </div>

  <!-- Lista de productos -->
  <div *ngIf="!loading && !error" class="grid">
    <div *ngFor="let product of products; trackBy: trackById" class="card">
      <!-- Editando -->
      <div *ngIf="editingId === product.id" class="card-body">
        <input [(ngModel)]="editedProduct!.name" placeholder="Nombre" />
        <input [(ngModel)]="editedProduct!.sku" placeholder="SKU" />
        <input [(ngModel)]="editedProduct!.price" type="number" placeholder="Precio" />
        <textarea [(ngModel)]="editedProduct!.description" placeholder="DescripciÃ³n"></textarea>

        <div class="card-actions">
          <button class="icon-btn save" (click)="saveEdit()">
            <span class="material-icons">check</span> Guardar
          </button>
          <button class="icon-btn cancel" (click)="cancelEdit()">
            <span class="material-icons">close</span> Cancelar
          </button>
        </div>
      </div>

      <!-- Vista normal -->
      <div *ngIf="editingId !== product.id" class="cards-container">
        <div class="card-header">
          <h3>{{ product.name }}</h3>
          <span class="sku">SKU: {{ product.sku }}</span>
        </div>
        <div class="card-body">
          <p>{{ product.description }}</p>
          <p class="price">ðŸ’² {{ product.price | currency:'USD':'symbol' }}</p>
        </div>
        <div class="card-actions">
          <button class="icon-btn edit" (click)="startEdit(product)">
            <span class="material-icons">edit</span>
          </button>
          <button class="icon-btn delete" (click)="deleteProduct(product.id!)">
            <span class="material-icons">delete</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- PaginaciÃ³n -->
  <div class="pagination" *ngIf="products.length || loading">
    <button [disabled]="!canPrev()" (click)="prevPage()">Anterior</button>
    <span>PÃ¡gina {{ page }}</span>
    <button [disabled]="!canNext()" (click)="nextPage()">Siguiente</button>
  </div>

  <!-- Recargar productos -->
  <div class="actions">
    <button (click)="reload()" class="refresh-btn">
      <span class="material-icons">refresh</span>
      Recargar productos
    </button>
  </div>
</section>